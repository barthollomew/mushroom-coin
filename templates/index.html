<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🍄 Mushroom Coin 🍄</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <div class="container">
        <h1>🍄 Mushroom Coin 🍄</h1>
        <p>Once upon a time, in a magical forest, a group of friendly mushrooms decided to create their own currency. They called it Mushroom Coin! They spent countless hours perfecting the algorithm and mining process, and soon enough, their currency became widely adopted among the creatures of the forest.</p>
        <h2>Mine a Block ⛏️</h2>
        <form onsubmit="event.preventDefault(); mineBlock();">
            <label for="miner_address">Miner Address:</label>
            <input type="text" id="miner_address" name="miner_address" required>
            <button type="submit">Mine</button>
        </form>

        <h2>New Transaction 💸</h2>
        <form onsubmit="event.preventDefault(); makeTransaction();">
            <label for="sender">Sender:</label>
            <input type="text" id="sender" name="sender" required>
            <label for="receiver">Receiver:</label>
            <input type="text" id="receiver" name="receiver" required>
            <label for="amount">Amount:</label>
            <input type="number" id="amount" name="amount" step="0.01" required>
            <button type="submit">Submit</button>
        </form>

        <h2>Blockchain ⛓️</h2>
        <button onclick="getChain()">View Chain</button>
        <pre id="chain"></pre>
    </div>

    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
    <script>
        function makeTransaction() {
            const sender = document.getElementById('sender').value;
            const receiver = document.getElementById('receiver').value;
            const amount = document.getElementById('amount').value;

            fetch('/transactions/new', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `sender=${sender}&receiver=${receiver}&amount=${amount}`
            })
            .then(response => response.json())
            .then(data => alert(data.message))
            .catch((error) => console.error('Error:', error));
        }

        function mineBlock() {
            const minerAddress = document.getElementById('miner_address').value;

            fetch('/mine', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `miner_address=${minerAddress}`
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message + '\\n' + 'Block Hash: ' + data.block.hash);
            })
            .catch((error) => console.error('Error:', error));
        }
    </script>
</body>
</html>
